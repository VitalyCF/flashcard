
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="flip-animation.html">

<dom-module id="flash-card">
<style>
  :host {
    display: block;
    vertical-align: middle;
    text-align: center;
  }

  neon-animated-pages {
    padding: 20px;
    position: relative;
  }

  neon-animatable {
    min-height: 300px;
    top: 10px;
    left: 10px;
    bottom: 10px;
    right: 10px;
    border: 1px solid silver;
  }
</style>

<template>
    <div class="layout vertical" >
      <p>Card: <span>{{card.id}}<span></p>

      <!-- card flip -->
      <neon-animated-pages id="pages" class="flex" on-tap="_flip" selected="0" entry-animation="flip-in-animation" exit-animation="flip-out-animation">
        <neon-animatable><p>{{card.question}}</p></neon-animatable>
        <neon-animatable><p>{{card.answer}}</p></neon-animatable>
      </neon-animated-pages>

      <!-- buttons -->
      <div class="fixed-bottom layout horizontal" style="margin: 10px">
        <paper-button raised on-tap="_reset">:-(</paper-button>
        <div class="flex"></div>
        <paper-button raised on-tap="_space">:-)</paper-button>
      </div>
    </div>
</template>

  <script>
    'use strict';

    Polymer({
      is: 'flash-card',

      properties: {
        card: {type: Object, value: {}, notify: true},
        deck: {type: Number, observer: '_deckChanged'}
      },

      created: function() {
        console.log('Card created: ', new Date());
      },

      ready: function() {
        this._next();
      },

      _deckChanged: function() {
        console.log('Selected deck: ' + this.deck);

        //this._next();
      },

      // next card
      _next: function() {
         db.nextCard().then(function(c) {
           this.card = c;
        }.bind(this));
      },

        // Very basic spaced repetition.
  		_space: function() {
  			if (this.card.interval != 0) {
  				this.card.interval = 2 * this.card.interval;
  			} else {
          this.card.interval = 1.0;
        }

        db.updateInterval(this.card);
  		},

      // Цээжлээгүй бол интервалыг шинэчилэн давтах
  		_reset: function() {
  			if (this.card.interval != 0) {
  				this.card.interval = 1.01 * this.card.interval;
  			} else {
          this.card.interval = 0.3;
        }

        db.updateInterval(this.card);
  		},

      _add: function() {
        // TODO: add new card
      },

      _flip: function() {
        if (this.$.pages.selected == 0) {
          this.$.pages.selected = 1;
        } else {
          this.$.pages.selected = 0;

        }
      }


    });
  </script>

</dom-module>
