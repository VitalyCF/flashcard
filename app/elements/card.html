
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="flip-animation.html">

<dom-module id="flash-card">
<style>
  :host {
    display: block;
    width: 100%;
    height: 100%;
    vertical-align: middle;
    text-align: center;
  }

  neon-animated-pages {
    position: relative;
  }

  neon-animatable {
    min-height: 300px;
    top: 10px;
    left: 10px;
    bottom: 10px;
    right: 10px;
    @apply(--shadow-elevation-2dp);
  }

  #front {
    width: 100%;
    height: 100%
    cursor: pointer;
  }

  #back {
    width: 100%;
    height: 100%;
    background: silver;
  }
</style>

<template>
    <div class="layout vertical" >
      <div class="layout horizontal" style="margin: 10px">
        <paper-button raised on-tap="_reset">:-(</paper-button>
        <div class="flex"></div>
        <paper-button raised on-tap="_space">:-)</paper-button>
      </div>

      <!-- card flip -->
      <neon-animated-pages id="pages" class="flex" on-tap="_flip" selected="0">
        <neon-animatable>
            <div id="front">front</div>
        </neon-animatable>
        <neon-animatable>
            <div id="back">back</div>
        </neon-animatable>
      </neon-animated-pages>

      <!-- response buttons -->
      
    </div>
</template>

  <script>
    Polymer({
      is: 'flash-card',

      properties: {
        card: {
          type: Object, 
          value: function() { return {}; }, 
          notify: true,
          observer: "_cardChanged"
        }
      },

      ready: function() {
        this.$.pages.selected = 0;
      },

      _cardChanged: function(e) {
        this.$.front.innerText = this.card.question || "no data";
        this.$.back.innerText = "";
        this.$.pages.selected = 0;
      },

      _flip: function(e) {
        e.preventDefault();

        this.$.pages.entryAnimation = "flip-in-animation";
        this.$.pages.exitAnimation = "flip-out-animation";

        if (this.$.pages.selected === 0) {
          this.$.back.innerText = this.card.answer || "no data";
          this.$.pages.selected = 1;
        } else {
          this.$.pages.selected = 0;
        }
      },

      _reset: function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        // Цээжлээгүй бол интервалыг шинэчилэн давтах
        if (this.card.interval) {
          this.card.interval = 1.01 * this.card.interval;
        } else {
          this.card.interval = 0.3;
        }

        this.fire('next');
      },

      _space: function(e) {
        e.preventDefault();
        e.stopPropagation();

        // Very basic spaced repetition.
        if (this.card.interval) {
           this.card.interval = 2 * this.card.interval;
        } else {
           this.card.interval = 1.0;
        }

        this.fire('next');
      }


    });
  </script>

</dom-module>
